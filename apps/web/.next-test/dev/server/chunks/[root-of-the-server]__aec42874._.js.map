{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 80, "column": 0}, "map": {"version":3,"sources":["file:///D:/Users/HI/Documents/GitHub/testTemplateGithub/lib/logger.ts"],"sourcesContent":["/**\r\n * Centralized Logging System\r\n */\r\n\r\nexport enum LogLevel {\r\n  ERROR = 'error',\r\n  WARN = 'warn',\r\n  INFO = 'info',\r\n  DEBUG = 'debug',\r\n}\r\n\r\ninterface LogEntry {\r\n  level: LogLevel;\r\n  message: string;\r\n  timestamp: string;\r\n  context?: any;\r\n  error?: Error;\r\n}\r\n\r\nclass Logger {\r\n  private isDevelopment = process.env.NODE_ENV === 'development';\r\n\r\n  private formatLog(entry: LogEntry): string {\r\n    const { level, message, timestamp, context } = entry;\r\n    let log = `[${timestamp}] [${level.toUpperCase()}] ${message}`;\r\n    \r\n    if (context) {\r\n      log += `\\nContext: ${JSON.stringify(context, null, 2)}`;\r\n    }\r\n    \r\n    if (entry.error) {\r\n      log += `\\nError: ${entry.error.message}\\nStack: ${entry.error.stack}`;\r\n    }\r\n    \r\n    return log;\r\n  }\r\n\r\n  private log(level: LogLevel, message: string, context?: any, error?: Error) {\r\n    const entry: LogEntry = {\r\n      level,\r\n      message,\r\n      timestamp: new Date().toISOString(),\r\n      context,\r\n      error,\r\n    };\r\n\r\n    const formattedLog = this.formatLog(entry);\r\n\r\n    // Console output based on environment\r\n    if (this.isDevelopment) {\r\n      switch (level) {\r\n        case LogLevel.ERROR:\r\n          console.error(formattedLog);\r\n          break;\r\n        case LogLevel.WARN:\r\n          console.warn(formattedLog);\r\n          break;\r\n        case LogLevel.INFO:\r\n          console.info(formattedLog);\r\n          break;\r\n        case LogLevel.DEBUG:\r\n          console.debug(formattedLog);\r\n          break;\r\n      }\r\n    } else {\r\n      // In production, you would send to external logging service\r\n      // e.g., Sentry, DataDog, CloudWatch, etc.\r\n      console.log(JSON.stringify(entry));\r\n    }\r\n  }\r\n\r\n  error(message: string, error?: Error, context?: any) {\r\n    this.log(LogLevel.ERROR, message, context, error);\r\n  }\r\n\r\n  warn(message: string, context?: any) {\r\n    this.log(LogLevel.WARN, message, context);\r\n  }\r\n\r\n  info(message: string, context?: any) {\r\n    this.log(LogLevel.INFO, message, context);\r\n  }\r\n\r\n  debug(message: string, context?: any) {\r\n    if (this.isDevelopment) {\r\n      this.log(LogLevel.DEBUG, message, context);\r\n    }\r\n  }\r\n}\r\n\r\nexport const logger = new Logger();\r\n"],"names":[],"mappings":"AAAA;;CAEC;;;;;;AAEM,IAAA,AAAK,kCAAA;;;;;WAAA;;AAeZ,MAAM;IACI,gBAAgB,oDAAyB,cAAc;IAEvD,UAAU,KAAe,EAAU;QACzC,MAAM,EAAE,KAAK,EAAE,OAAO,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG;QAC/C,IAAI,MAAM,CAAC,CAAC,EAAE,UAAU,GAAG,EAAE,MAAM,WAAW,GAAG,EAAE,EAAE,SAAS;QAE9D,IAAI,SAAS;YACX,OAAO,CAAC,WAAW,EAAE,KAAK,SAAS,CAAC,SAAS,MAAM,IAAI;QACzD;QAEA,IAAI,MAAM,KAAK,EAAE;YACf,OAAO,CAAC,SAAS,EAAE,MAAM,KAAK,CAAC,OAAO,CAAC,SAAS,EAAE,MAAM,KAAK,CAAC,KAAK,EAAE;QACvE;QAEA,OAAO;IACT;IAEQ,IAAI,KAAe,EAAE,OAAe,EAAE,OAAa,EAAE,KAAa,EAAE;QAC1E,MAAM,QAAkB;YACtB;YACA;YACA,WAAW,IAAI,OAAO,WAAW;YACjC;YACA;QACF;QAEA,MAAM,eAAe,IAAI,CAAC,SAAS,CAAC;QAEpC,sCAAsC;QACtC,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,OAAQ;gBACN;oBACE,QAAQ,KAAK,CAAC;oBACd;gBACF;oBACE,QAAQ,IAAI,CAAC;oBACb;gBACF;oBACE,QAAQ,IAAI,CAAC;oBACb;gBACF;oBACE,QAAQ,KAAK,CAAC;oBACd;YACJ;QACF,OAAO;YACL,4DAA4D;YAC5D,0CAA0C;YAC1C,QAAQ,GAAG,CAAC,KAAK,SAAS,CAAC;QAC7B;IACF;IAEA,MAAM,OAAe,EAAE,KAAa,EAAE,OAAa,EAAE;QACnD,IAAI,CAAC,GAAG,UAAiB,SAAS,SAAS;IAC7C;IAEA,KAAK,OAAe,EAAE,OAAa,EAAE;QACnC,IAAI,CAAC,GAAG,SAAgB,SAAS;IACnC;IAEA,KAAK,OAAe,EAAE,OAAa,EAAE;QACnC,IAAI,CAAC,GAAG,SAAgB,SAAS;IACnC;IAEA,MAAM,OAAe,EAAE,OAAa,EAAE;QACpC,IAAI,IAAI,CAAC,aAAa,EAAE;YACtB,IAAI,CAAC,GAAG,UAAiB,SAAS;QACpC;IACF;AACF;AAEO,MAAM,SAAS,IAAI"}},
    {"offset": {"line": 161, "column": 0}, "map": {"version":3,"sources":["file:///D:/Users/HI/Documents/GitHub/testTemplateGithub/lib/prisma.ts"],"sourcesContent":["import dotenv from 'dotenv';\r\nconst envState = `[${new Date().toISOString()}] NODE_ENV: ${process.env.NODE_ENV}, IS_PLAYWRIGHT: ${process.env.IS_PLAYWRIGHT}`;\r\ntry {\r\n  const fs = require('fs');\r\n  fs.appendFileSync('prisma_debug.log', `${envState}\\n`);\r\n} catch (e) { }\r\n\r\nif (process.env.NODE_ENV === 'test' || process.env.IS_PLAYWRIGHT === 'true') {\r\n  dotenv.config({ path: '.env.test', override: true });\r\n} else if (process.env.NODE_ENV === 'development') {\r\n  // Only load .env.local in development; Vercel provides env vars directly\r\n  dotenv.config({ path: '.env.local' });\r\n}\r\n\r\nconst dbUrlLog = `[${new Date().toISOString()}] DB URL HOST: ${process.env.DATABASE_URL?.split('@')[1]?.split('/')[0] || 'unknown'}`;\r\ntry {\r\n  const fs = require('fs');\r\n  fs.appendFileSync('prisma_debug.log', `${dbUrlLog}\\n\\n`);\r\n} catch (e) { }\r\n\r\nimport { PrismaClient, Prisma } from '@prisma/client';\r\nimport { PrismaPg } from '@prisma/adapter-pg';\r\nimport { Pool } from 'pg';\r\nimport { logger } from './logger';\r\n\r\nexport { Prisma };\r\n\r\n// Prevent multiple instances of Prisma Client in development\r\nconst globalForPrisma = globalThis as unknown as {\r\n  prisma: PrismaClient | undefined;\r\n  pool: Pool | undefined;\r\n};\r\n\r\nconst connectionString = process.env.DATABASE_URL?.includes('localhost')\r\n  ? process.env.DATABASE_URL.replace('localhost', '127.0.0.1')\r\n  : process.env.DATABASE_URL;\r\n\r\nif (!connectionString) {\r\n  logger.error('DATABASE_URL is not defined in lib/prisma.ts');\r\n  console.log('[DEBUG] DATABASE_URL is MISSING');\r\n} else {\r\n  const host = connectionString.split('@')[1]?.split('/')[0] || 'no-host';\r\n  const dbName = connectionString.split('/').pop()?.split('?')[0] || 'no-db';\r\n  logger.info(`Initializing Prisma with Host: ${host}, DB: ${dbName}`);\r\n  console.log(`[DEBUG] Prisma Source: ${process.env.NODE_ENV} | Host: ${host} | URL Length: ${connectionString.length}`);\r\n}\r\n\r\n// Create PostgreSQL connection pool\r\nconst pool = globalForPrisma.pool ?? new Pool({ connectionString });\r\nconst adapter = new PrismaPg(pool);\r\n\r\n// Optimized Prisma Client configuration\r\nconst prismaConfig: any = {\r\n  adapter,\r\n  log: [\r\n    {\r\n      emit: 'event',\r\n      level: 'query',\r\n    },\r\n    {\r\n      emit: 'event',\r\n      level: 'error',\r\n    },\r\n    {\r\n      emit: 'event',\r\n      level: 'warn',\r\n    },\r\n  ],\r\n};\r\n\r\nexport const prisma = globalForPrisma.prisma ?? new PrismaClient(prismaConfig);\r\n\r\n// Log slow queries in development\r\nif (process.env.NODE_ENV === 'development') {\r\n  prisma.$on('query' as never, (e: any) => {\r\n    if (e.duration > 1000) {\r\n      // Log queries taking more than 1 second\r\n      logger.warn('Slow query detected', {\r\n        query: e.query,\r\n        duration: `${e.duration}ms`,\r\n        params: e.params,\r\n      });\r\n    }\r\n  });\r\n}\r\n\r\n// Log errors\r\nprisma.$on('error' as never, (e: any) => {\r\n  logger.error('Prisma error', e instanceof Error ? e : undefined, {\r\n    target: e.target,\r\n    timestamp: e.timestamp,\r\n    message: e.message,\r\n  });\r\n});\r\n\r\n// Log warnings\r\nprisma.$on('warn' as never, (e: any) => {\r\n  logger.warn('Prisma warning', {\r\n    message: e.message,\r\n    timestamp: e.timestamp,\r\n  });\r\n});\r\n\r\n\r\nif (process.env.NODE_ENV !== 'production') {\r\n  globalForPrisma.prisma = prisma;\r\n  if (pool) {\r\n    globalForPrisma.pool = pool;\r\n  }\r\n}\r\n\r\n// Graceful shutdown\r\nprocess.on('beforeExit', async () => {\r\n  await prisma.$disconnect();\r\n  if (pool) {\r\n    await pool.end();\r\n  }\r\n});\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 286, "column": 0}, "map": {"version":3,"sources":["file:///D:/Users/HI/Documents/GitHub/testTemplateGithub/services/dashboard.service.ts"],"sourcesContent":["import { prisma, Prisma } from '@/lib/prisma';\r\nimport {\r\n  DashboardKPIs,\r\n  TopProduct,\r\n  WarehouseUtilization,\r\n  BranchComparison,\r\n  DashboardFilters,\r\n  ARAPAging,\r\n  AgingBucket,\r\n  SalesOrderSummary,\r\n  DashboardActivity\r\n} from '@/types/dashboard.types';\r\n\r\nimport { inventoryService } from './inventory.service';\r\n\r\nexport class DashboardService {\r\n  async getKPIs(filters?: DashboardFilters): Promise<DashboardKPIs> {\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n\r\n    const tomorrow = new Date(today);\r\n    tomorrow.setDate(tomorrow.getDate() + 1);\r\n\r\n    const firstDayOfMonth = new Date(today.getFullYear(), today.getMonth(), 1);\r\n\r\n    // Execute all independent queries in parallel\r\n    const [\r\n      totalProducts,\r\n      inventoryItems,\r\n      activeSalesOrders,\r\n      totalSalesOrders,\r\n      convertedOrders,\r\n      products,\r\n      todaySales,\r\n      arRecords,\r\n      overdueReceivables,\r\n      apRecords,\r\n      overduePayables,\r\n      expenses,\r\n    ] = await Promise.all([\r\n      // Total active products\r\n      prisma.product.count({\r\n        where: { status: 'active' },\r\n      }),\r\n\r\n      // Total stock units\r\n      prisma.inventory.findMany({\r\n        where: {\r\n          ...(filters?.branchId ? { Warehouse: { branchId: filters.branchId } } : {}),\r\n        },\r\n      }),\r\n\r\n      // Active sales orders\r\n      prisma.salesOrder.count({\r\n        where: {\r\n          status: { in: ['pending', 'draft'] },\r\n          ...(filters?.branchId ? { branchId: filters.branchId } : {}),\r\n        },\r\n      }),\r\n\r\n      // Total sales orders\r\n      prisma.salesOrder.count({\r\n        where: {\r\n          ...(filters?.branchId ? { branchId: filters.branchId } : {}),\r\n        },\r\n      }),\r\n\r\n      // Converted orders\r\n      prisma.salesOrder.count({\r\n        where: {\r\n          salesOrderStatus: 'converted',\r\n          ...(filters?.branchId ? { branchId: filters.branchId } : {}),\r\n        },\r\n      }),\r\n\r\n      // Products with inventory for value calculation\r\n      prisma.product.findMany({\r\n        where: { status: 'active' },\r\n        include: {\r\n          Inventory: {\r\n            where: {\r\n              ...(filters?.branchId ? { Warehouse: { branchId: filters.branchId } } : {}),\r\n            },\r\n          },\r\n        },\r\n      }),\r\n\r\n      // Today's POS sales\r\n      prisma.pOSSale.findMany({\r\n        where: {\r\n          createdAt: { gte: today, lt: tomorrow },\r\n          ...(filters?.branchId ? { branchId: filters.branchId } : {}),\r\n        },\r\n      }),\r\n\r\n      // Outstanding AR\r\n      prisma.accountsReceivable.findMany({\r\n        where: {\r\n          status: { in: ['pending', 'partial'] },\r\n          ...(filters?.branchId ? { branchId: filters.branchId } : {}),\r\n        },\r\n      }),\r\n\r\n      // Overdue receivables\r\n      prisma.accountsReceivable.count({\r\n        where: {\r\n          status: 'overdue',\r\n          ...(filters?.branchId ? { branchId: filters.branchId } : {}),\r\n        },\r\n      }),\r\n\r\n      // Outstanding AP\r\n      prisma.accountsPayable.findMany({\r\n        where: {\r\n          status: { in: ['pending', 'partial'] },\r\n          ...(filters?.branchId ? { branchId: filters.branchId } : {}),\r\n        },\r\n      }),\r\n\r\n      // Overdue payables\r\n      prisma.accountsPayable.count({\r\n        where: {\r\n          status: 'overdue',\r\n          ...(filters?.branchId ? { branchId: filters.branchId } : {}),\r\n        },\r\n      }),\r\n\r\n      // Current month expenses\r\n      prisma.expense.findMany({\r\n        where: {\r\n          expenseDate: { gte: firstDayOfMonth },\r\n          ...(filters?.branchId ? { branchId: filters.branchId } : {}),\r\n        },\r\n      }),\r\n    ]);\r\n\r\n    // Calculate derived values\r\n    const totalStock = inventoryItems.reduce((sum, item) => sum + Number(item.quantity), 0);\r\n\r\n    const salesOrderConversionRate = totalSalesOrders > 0\r\n      ? (convertedOrders / totalSalesOrders) * 100\r\n      : 0;\r\n\r\n    // Inventory value (weighted average)\r\n    let inventoryValue = new Prisma.Decimal(0);\r\n    for (const product of products) {\r\n      const productTotalStock = product.Inventory.reduce((sum, item) => sum + Number(item.quantity), 0);\r\n      const productValue = new Prisma.Decimal(productTotalStock).times(product.averageCostPrice || 0);\r\n      inventoryValue = inventoryValue.plus(productValue);\r\n    }\r\n\r\n    const todaySalesCount = todaySales.length;\r\n    const todaySalesRevenue = todaySales.reduce(\r\n      (sum, sale) => sum.plus(sale.totalAmount),\r\n      new Prisma.Decimal(0)\r\n    );\r\n\r\n    const outstandingAR = arRecords.reduce(\r\n      (sum, ar) => sum.plus(ar.balance),\r\n      new Prisma.Decimal(0)\r\n    );\r\n\r\n    const outstandingAP = apRecords.reduce(\r\n      (sum, ap) => sum.plus(ap.balance),\r\n      new Prisma.Decimal(0)\r\n    );\r\n\r\n    const currentMonthExpenses = expenses.reduce(\r\n      (sum, exp) => sum.plus(exp.amount),\r\n      new Prisma.Decimal(0)\r\n    );\r\n\r\n    // Calculate profit\r\n    // Gross Profit = Today's Sales Revenue - Cost of Goods Sold for those sales\r\n    const todayCogs = todaySales.reduce((sum, sale) => {\r\n      // Note: This assumes POSSale has calculated COGS or we need to sum items\r\n      // For simplicity, we'll try to find associated items if COGS isn't direct\r\n      return sum.plus(new Prisma.Decimal(0)); // Placeholder if COGS is complex\r\n    }, new Prisma.Decimal(0));\r\n\r\n    // A better approach for the dashboard KPIs:\r\n    // Profit for the current month\r\n    const firstDay = new Date(today.getFullYear(), today.getMonth(), 1);\r\n    const monthSales = await prisma.pOSSale.findMany({\r\n      where: {\r\n        createdAt: { gte: firstDay },\r\n        ...(filters?.branchId ? { branchId: filters.branchId } : {}),\r\n      },\r\n      include: {\r\n        POSSaleItem: true,\r\n      }\r\n    });\r\n\r\n    const monthRevenue = monthSales.reduce((sum, s) => sum.plus(s.totalAmount), new Prisma.Decimal(0));\r\n    const monthCogs = monthSales.reduce((sum, s) => {\r\n      const saleCogs = s.POSSaleItem.reduce((iSum, i) => iSum.plus(i.costOfGoodsSold), new Prisma.Decimal(0));\r\n      return sum.plus(saleCogs);\r\n    }, new Prisma.Decimal(0));\r\n\r\n    const grossProfit = monthRevenue.minus(monthCogs);\r\n    const netProfit = grossProfit.minus(currentMonthExpenses);\r\n\r\n    return {\r\n      totalProducts,\r\n      totalStock,\r\n      activeSalesOrders,\r\n      salesOrderConversionRate: Math.round(salesOrderConversionRate * 100) / 100,\r\n      inventoryValue,\r\n      todaySalesCount,\r\n      todaySalesRevenue,\r\n      outstandingAR,\r\n      outstandingAP,\r\n      currentMonthExpenses,\r\n      overdueReceivables,\r\n      overduePayables,\r\n      grossProfit,\r\n      netProfit,\r\n    };\r\n  }\r\n\r\n  async getTopSellingProducts(limit: number = 5, branchId?: string): Promise<TopProduct[]> {\r\n    const salesItems = await prisma.pOSSaleItem.findMany({\r\n      where: {\r\n        ...(branchId ? { POSSale: { branchId } } : {}),\r\n      },\r\n      include: {\r\n        Product: true,\r\n      },\r\n    });\r\n\r\n    // Group by product\r\n    const productMap = new Map<string, { name: string; quantity: Prisma.Decimal; revenue: Prisma.Decimal }>();\r\n\r\n    for (const item of salesItems) {\r\n      const existing = productMap.get(item.productId);\r\n      if (existing) {\r\n        existing.quantity = existing.quantity.plus(item.quantity);\r\n        existing.revenue = existing.revenue.plus(item.subtotal);\r\n      } else {\r\n        productMap.set(item.productId, {\r\n          name: item.Product.name,\r\n          quantity: new Prisma.Decimal(item.quantity),\r\n          revenue: new Prisma.Decimal(item.subtotal),\r\n        });\r\n      }\r\n    }\r\n\r\n    // Convert to array and sort by revenue\r\n    const products = Array.from(productMap.entries())\r\n      .map(([productId, data]) => ({\r\n        productId,\r\n        productName: data.name,\r\n        quantitySold: Number(data.quantity),\r\n        revenue: data.revenue,\r\n      }))\r\n      .sort((a, b) => Number(b.revenue.minus(a.revenue)));\r\n\r\n    return products.slice(0, limit);\r\n  }\r\n\r\n  async getWarehouseUtilization(branchId?: string): Promise<WarehouseUtilization[]> {\r\n    const warehouses = await prisma.warehouse.findMany({\r\n      where: {\r\n        ...(branchId ? { branchId } : {}),\r\n      },\r\n      include: {\r\n        Inventory: true,\r\n      },\r\n    });\r\n\r\n    return warehouses.map((warehouse) => {\r\n      const currentStock = warehouse.Inventory.reduce(\r\n        (sum, item) => sum + Number(item.quantity),\r\n        0\r\n      );\r\n\r\n      const utilizationPercentage = warehouse.maxCapacity > 0\r\n        ? (currentStock / warehouse.maxCapacity) * 100\r\n        : 0;\r\n\r\n      let status: 'normal' | 'warning' | 'critical' = 'normal';\r\n      if (utilizationPercentage >= 80) {\r\n        status = 'critical';\r\n      } else if (utilizationPercentage >= 60) {\r\n        status = 'warning';\r\n      }\r\n\r\n      return {\r\n        warehouseId: warehouse.id,\r\n        warehouseName: warehouse.name,\r\n        branchId: warehouse.branchId,\r\n        maxCapacity: warehouse.maxCapacity,\r\n        currentStock,\r\n        utilizationPercentage: Math.round(utilizationPercentage * 100) / 100,\r\n        status,\r\n      };\r\n    });\r\n  }\r\n\r\n  async getBranchComparison(): Promise<BranchComparison[]> {\r\n    const branches = await prisma.branch.findMany({\r\n      where: { status: 'active' },\r\n      include: {\r\n        POSSale: {\r\n          include: {\r\n            POSSaleItem: true,\r\n          },\r\n        },\r\n        Expense: true,\r\n        Warehouse: {\r\n          include: {\r\n            Inventory: {\r\n              include: {\r\n                Product: true\r\n              }\r\n            }\r\n          }\r\n        }\r\n      },\r\n    });\r\n\r\n    const comparisons: BranchComparison[] = [];\r\n\r\n    for (const branch of branches) {\r\n      // Calculate revenue\r\n      const revenue = branch.POSSale.reduce(\r\n        (sum, sale) => sum.plus(sale.totalAmount),\r\n        new Prisma.Decimal(0)\r\n      );\r\n\r\n      // Calculate expenses\r\n      const expenses = branch.Expense.reduce(\r\n        (sum, exp) => sum.plus(exp.amount),\r\n        new Prisma.Decimal(0)\r\n      );\r\n\r\n      // Calculate COGS\r\n      const cogs = branch.POSSale.reduce((sum, sale) => {\r\n        const saleCogs = sale.POSSaleItem.reduce(\r\n          (itemSum, item) => itemSum.plus(item.costOfGoodsSold),\r\n          new Prisma.Decimal(0)\r\n        );\r\n        return sum.plus(saleCogs);\r\n      }, new Prisma.Decimal(0));\r\n\r\n      // Profit = Revenue - COGS - Expenses\r\n      const profit = revenue.minus(cogs).minus(expenses);\r\n\r\n      // Get inventory value for this branch\r\n      let inventoryValue = new Prisma.Decimal(0);\r\n      for (const warehouse of branch.Warehouse) {\r\n        for (const item of warehouse.Inventory) {\r\n          const itemValue = new Prisma.Decimal(item.quantity).times(item.Product.averageCostPrice || 0);\r\n          inventoryValue = inventoryValue.plus(itemValue);\r\n        }\r\n      }\r\n\r\n      comparisons.push({\r\n        branchId: branch.id,\r\n        branchName: branch.name,\r\n        revenue,\r\n        expenses,\r\n        profit,\r\n        inventoryValue,\r\n      });\r\n    }\r\n\r\n    return comparisons.sort((a, b) => Number(b.revenue.minus(a.revenue)));\r\n  }\r\n\r\n  async getSalesTrends(days: number = 7, branchId?: string): Promise<{ date: string; sales: number; revenue: number }[]> {\r\n    const today = new Date();\r\n    today.setHours(23, 59, 59, 999);\r\n\r\n    const startDate = new Date(today);\r\n    startDate.setDate(startDate.getDate() - days + 1);\r\n    startDate.setHours(0, 0, 0, 0);\r\n\r\n    // Get all sales within the date range\r\n    const sales = await prisma.pOSSale.findMany({\r\n      where: {\r\n        createdAt: { gte: startDate, lte: today },\r\n        ...(branchId ? { branchId } : {}),\r\n      },\r\n      orderBy: { createdAt: 'asc' },\r\n    });\r\n\r\n    // Group by date\r\n    const trendsMap = new Map<string, { count: number; revenue: Prisma.Decimal }>();\r\n\r\n    // Initialize all dates with zero\r\n    for (let i = 0; i < days; i++) {\r\n      const date = new Date(startDate);\r\n      date.setDate(date.getDate() + i);\r\n      const dateStr = date.toISOString().split('T')[0];\r\n      trendsMap.set(dateStr, { count: 0, revenue: new Prisma.Decimal(0) });\r\n    }\r\n\r\n    // Fill in actual data\r\n    for (const sale of sales) {\r\n      const dateStr = sale.createdAt.toISOString().split('T')[0];\r\n      const existing = trendsMap.get(dateStr);\r\n      if (existing) {\r\n        existing.count += 1;\r\n        existing.revenue = existing.revenue.plus(sale.totalAmount);\r\n      }\r\n    }\r\n\r\n    // Convert to array\r\n    return Array.from(trendsMap.entries())\r\n      .map(([date, data]) => ({\r\n        date: new Date(date).toLocaleDateString('en-US', { month: 'short', day: 'numeric' }),\r\n        sales: data.count,\r\n        revenue: Number(data.revenue),\r\n      }))\r\n      .sort((a, b) => {\r\n        const dateA = new Date(a.date);\r\n        const dateB = new Date(b.date);\r\n        return dateA.getTime() - dateB.getTime();\r\n      });\r\n  }\r\n\r\n  async getLowStockProducts(limit: number = 10, branchId?: string): Promise<{\r\n    productId: string;\r\n    productName: string;\r\n    currentStock: number;\r\n    minStockLevel: number;\r\n    status: 'low' | 'critical';\r\n  }[]> {\r\n    const products = await prisma.product.findMany({\r\n      where: {\r\n        status: 'active',\r\n      },\r\n      include: {\r\n        Inventory: {\r\n          where: {\r\n            ...(branchId ? { Warehouse: { branchId } } : {}),\r\n          },\r\n        },\r\n      },\r\n    });\r\n\r\n    const lowStockProducts = products\r\n      .map((product) => {\r\n        const currentStock = product.Inventory.reduce(\r\n          (sum, item) => sum + Number(item.quantity),\r\n          0\r\n        );\r\n\r\n        let status: 'low' | 'critical' = 'low';\r\n        if (currentStock === 0 || currentStock < product.minStockLevel * 0.5) {\r\n          status = 'critical';\r\n        }\r\n\r\n        return {\r\n          productId: product.id,\r\n          productName: product.name,\r\n          currentStock,\r\n          minStockLevel: product.minStockLevel,\r\n          status,\r\n        };\r\n      })\r\n      .filter((p) => p.currentStock <= p.minStockLevel)\r\n      .sort((a, b) => {\r\n        // Critical first, then by percentage below minimum\r\n        if (a.status === 'critical' && b.status !== 'critical') return -1;\r\n        if (a.status !== 'critical' && b.status === 'critical') return 1;\r\n        const aPercentage = a.currentStock / a.minStockLevel;\r\n        const bPercentage = b.currentStock / b.minStockLevel;\r\n        return aPercentage - bPercentage;\r\n      });\r\n\r\n    return lowStockProducts.slice(0, limit);\r\n  }\r\n\r\n  async getEntityCounts(branchId?: string): Promise<Record<string, number>> {\r\n    const [\r\n      products,\r\n      warehouses,\r\n      branches,\r\n      customers,\r\n      suppliers,\r\n      purchaseOrders,\r\n      receivingVouchers,\r\n      salesOrders,\r\n      users,\r\n      roles\r\n    ] = await Promise.all([\r\n      prisma.product.count({ where: { status: 'active' } }),\r\n      prisma.warehouse.count({\r\n        where: {\r\n          ...(branchId ? { branchId } : {}),\r\n        },\r\n      }),\r\n      prisma.branch.count({ where: { status: 'active' } }),\r\n      prisma.customer.count({ where: { status: 'active' } }),\r\n      prisma.supplier.count({ where: { status: 'active' } }),\r\n      prisma.purchaseOrder.count({\r\n        where: {\r\n          status: { not: 'cancelled' },\r\n          ...(branchId ? { branchId } : {}),\r\n        },\r\n      }),\r\n      prisma.receivingVoucher.count({\r\n        where: {\r\n          ...(branchId ? { branchId } : {}),\r\n        },\r\n      }),\r\n      prisma.salesOrder.count({\r\n        where: {\r\n          status: { not: 'cancelled' },\r\n          ...(branchId ? { branchId } : {}),\r\n        },\r\n      }),\r\n      prisma.user.count({ where: { status: 'ACTIVE' } }),\r\n      prisma.role.count(),\r\n    ]);\r\n\r\n    return {\r\n      products,\r\n      warehouses,\r\n      branches,\r\n      customers,\r\n      suppliers,\r\n      purchaseOrders,\r\n      receivingVouchers,\r\n      salesOrders,\r\n      users,\r\n      roles,\r\n    };\r\n  }\r\n\r\n  async getARPayableAging(branchId?: string): Promise<ARAPAging> {\r\n    const today = new Date();\r\n\r\n    // helper to get buckets\r\n    const calculateBuckets = (items: any[]): AgingBucket[] => {\r\n      const buckets: Record<string, { amount: Prisma.Decimal; count: number }> = {\r\n        '0-30': { amount: new Prisma.Decimal(0), count: 0 },\r\n        '31-60': { amount: new Prisma.Decimal(0), count: 0 },\r\n        '61-90': { amount: new Prisma.Decimal(0), count: 0 },\r\n        '90+': { amount: new Prisma.Decimal(0), count: 0 },\r\n      };\r\n\r\n      items.forEach(item => {\r\n        const dueDate = new Date(item.dueDate);\r\n        const diffDays = Math.floor((today.getTime() - dueDate.getTime()) / (1000 * 3600 * 24));\r\n\r\n        if (diffDays <= 30) {\r\n          buckets['0-30'].amount = buckets['0-30'].amount.plus(item.balance);\r\n          buckets['0-30'].count++;\r\n        } else if (diffDays <= 60) {\r\n          buckets['31-60'].amount = buckets['31-60'].amount.plus(item.balance);\r\n          buckets['31-60'].count++;\r\n        } else if (diffDays <= 90) {\r\n          buckets['61-90'].amount = buckets['61-90'].amount.plus(item.balance);\r\n          buckets['61-90'].count++;\r\n        } else {\r\n          buckets['90+'].amount = buckets['90+'].amount.plus(item.balance);\r\n          buckets['90+'].count++;\r\n        }\r\n      });\r\n\r\n      return Object.entries(buckets).map(([bucket, data]) => ({\r\n        bucket: bucket as any,\r\n        amount: data.amount,\r\n        count: data.count,\r\n      }));\r\n    };\r\n\r\n    const [receivables, payables] = await Promise.all([\r\n      prisma.accountsReceivable.findMany({\r\n        where: {\r\n          status: { in: ['pending', 'partial', 'overdue'] },\r\n          ...(branchId ? { branchId } : {}),\r\n        },\r\n      }),\r\n      prisma.accountsPayable.findMany({\r\n        where: {\r\n          status: { in: ['pending', 'partial', 'overdue'] },\r\n          ...(branchId ? { branchId } : {}),\r\n        },\r\n      }),\r\n    ]);\r\n\r\n    return {\r\n      receivables: calculateBuckets(receivables),\r\n      payables: calculateBuckets(payables),\r\n    };\r\n  }\r\n\r\n  async getSalesOrderSummary(branchId?: string): Promise<SalesOrderSummary[]> {\r\n    const orders = await prisma.salesOrder.groupBy({\r\n      by: ['status'],\r\n      where: {\r\n        ...(branchId ? { branchId } : {}),\r\n      },\r\n      _count: {\r\n        _all: true,\r\n      },\r\n      _sum: {\r\n        totalAmount: true,\r\n      },\r\n    });\r\n\r\n    return orders.map(o => ({\r\n      status: o.status,\r\n      count: o._count._all,\r\n      totalAmount: new Prisma.Decimal(o._sum.totalAmount || 0),\r\n    }));\r\n  }\r\n\r\n  async getRecentActivities(limit: number = 10, branchId?: string): Promise<DashboardActivity[]> {\r\n    const [sales, purchases, adjustments, expenses] = await Promise.all([\r\n      prisma.pOSSale.findMany({\r\n        where: { ...(branchId ? { branchId } : {}) },\r\n        orderBy: { createdAt: 'desc' },\r\n        take: limit,\r\n      }),\r\n      prisma.purchaseOrder.findMany({\r\n        where: { ...(branchId ? { branchId } : {}) },\r\n        orderBy: { createdAt: 'desc' },\r\n        take: limit,\r\n      }),\r\n      prisma.inventoryAdjustment.findMany({\r\n        where: { ...(branchId ? { branchId } : {}) },\r\n        orderBy: { createdAt: 'desc' },\r\n        take: limit,\r\n      }),\r\n      prisma.expense.findMany({\r\n        where: { ...(branchId ? { branchId } : {}) },\r\n        orderBy: { createdAt: 'desc' },\r\n        take: limit,\r\n      }),\r\n    ]);\r\n\r\n    const activities: DashboardActivity[] = [\r\n      ...sales.map((s: any) => ({\r\n        id: s.id,\r\n        type: 'sale' as const,\r\n        description: `POS Sale #${s.id.slice(-6)}`,\r\n        amount: s.totalAmount,\r\n        status: s.status,\r\n        timestamp: s.createdAt,\r\n        referenceId: s.id,\r\n      })),\r\n      ...purchases.map((p: any) => ({\r\n        id: p.id,\r\n        type: 'purchase' as const,\r\n        description: `Purchase Order #${p.orderNumber}`,\r\n        amount: p.totalAmount,\r\n        status: p.status,\r\n        timestamp: p.createdAt,\r\n        referenceId: p.id,\r\n      })),\r\n      ...adjustments.map((a: any) => ({\r\n        id: a.id,\r\n        type: 'adjustment' as const,\r\n        description: `Inventory Adj: ${a.reason}`,\r\n        timestamp: a.createdAt,\r\n        referenceId: a.id,\r\n      })),\r\n      ...expenses.map((e: any) => ({\r\n        id: e.id,\r\n        type: 'expense' as const,\r\n        description: `Expense: ${e.description}`,\r\n        amount: e.amount,\r\n        timestamp: e.createdAt,\r\n        referenceId: e.id,\r\n      })),\r\n    ];\r\n\r\n    return activities\r\n      .sort((a, b) => b.timestamp.getTime() - a.timestamp.getTime())\r\n      .slice(0, limit);\r\n  }\r\n}\r\n\r\nexport const dashboardService = new DashboardService();\r\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 995, "column": 0}, "map": {"version":3,"sources":["file:///D:/Users/HI/Documents/GitHub/testTemplateGithub/app/api/dashboard/aging/route.ts"],"sourcesContent":["import { NextResponse } from 'next/server';\r\nimport { dashboardService } from '@/services/dashboard.service';\r\n\r\nexport const dynamic = 'force-dynamic';\r\n\r\nexport async function GET(request: Request) {\r\n    try {\r\n        const { searchParams } = new URL(request.url);\r\n        const branchId = searchParams.get('branchId') || undefined;\r\n\r\n        const aging = await dashboardService.getARPayableAging(branchId);\r\n\r\n        return NextResponse.json({ success: true, data: aging });\r\n    } catch (error: any) {\r\n        console.error('Error fetching dashboard aging data:', error);\r\n        return NextResponse.json(\r\n            { success: false, error: error.message },\r\n            { status: 500 }\r\n        );\r\n    }\r\n}\r\n"],"names":[],"mappings":";;;;;;AAAA;AACA;;;;;;;AAEO,MAAM,UAAU;AAEhB,eAAe,IAAI,OAAgB;IACtC,IAAI;QACA,MAAM,EAAE,YAAY,EAAE,GAAG,IAAI,IAAI,QAAQ,GAAG;QAC5C,MAAM,WAAW,aAAa,GAAG,CAAC,eAAe;QAEjD,MAAM,QAAQ,MAAM,sJAAgB,CAAC,iBAAiB,CAAC;QAEvD,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;YAAM,MAAM;QAAM;IAC1D,EAAE,OAAO,OAAY;QACjB,QAAQ,KAAK,CAAC,wCAAwC;QACtD,OAAO,gJAAY,CAAC,IAAI,CACpB;YAAE,SAAS;YAAO,OAAO,MAAM,OAAO;QAAC,GACvC;YAAE,QAAQ;QAAI;IAEtB;AACJ"}}]
}